@model Mediaverse.Application.JointContentConsumption.Commands.SwitchContent.Dtos.ContentDto

<div id="contentPlayer">
    <div class="content-player" style="height: 400px">
        @if (Model.Player != null)
        {
            <img width="100%" height="100%" src="/Resources/Images/NoContentToPlayImage.png" style="border-radius: 5px"/>
            <div id="iframeContainer"></div>
        }
        else
        {
            <img width="100%" height="100%" src="/Resources/Images/NoContentToPlayImage.png" style="border-radius: 5px"/>
        }
    </div>

    <div class="content-name">
        @if (Model.Player != null)
        {
            <h2>Currently playing: @Model.Title</h2>
        }
    </div>
    
    @if (Model.Player != null)
    {
        <script type="text/javascript">   
            var player;
        
            $(document).ready(function(){                      
                var tag = document.createElement('script');
                tag.src = "https://www.youtube.com/iframe_api";
                var firstScriptTag = document.getElementsByTagName('script')[0];
                firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
                
                createPlayer();
            });
    
            window.onYouTubeIframeAPIReady = function(){
                createPlayer();
            }
            
            function createPlayer() {
                player = new YT.Player('iframeContainer', {
                      width: '100%',
                      height: '100%',
                      videoId: '@Model.Id.ExternalId',
                      events: {
                        'onStateChange': onPlayerStateChange,
                      }
                });
            }
    
            function onPlayerStateChange(event) {
                // video is playing
                if (event.data === 1) {
                    onContentPlaybackStarted(player.getCurrentTime());
                }
                // video is paused
                else if (event.data === 2) {
                    onContentPlaybackPaused(player.getCurrentTime());
                }
            }       
            
            function startPlayback() {
                player.playVideo();
            }
            
            function pausePlayback() {
                player.pauseVideo();
            }
        </script>
    }
</div>